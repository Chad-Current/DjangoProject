{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="{% static 'baseapp/css/stylesheet.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'baseapp/css/index.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'dashboard/css/stylesheet.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'dashboard/css/progress.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'dashboard/css/dashboard-cards.css' %}" type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>

<body>
    {% include "baseapp/navbar.html" %}
    
    <div class="dashboard-wrapper">
        <!-- Hero Section with Stats -->
        <div class="hero-section">
            <div class="hero-content">
                <h1>
                    {% if not profile.full_name %}
                    Welcome {{ user.username }}
                    {% else %}
                    Welcome back {{ profile.full_name|default:user.username }}
                    {% endif %}
                </h1>
                <p>Your digital estate at a glance</p>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card" data-stat="tasks">
                    <div class="stat-icon-wrapper">
                        <img src="/static/accounts/images/Task--Streamline-Plump.svg" alt="" class="stat-icon">
                    </div>
                    <div class="stat-content">
                        {% if remaining_tasks >= 0 %}
                        <!-- <div class="stat-value"><h3></h3></div> -->
                        <div class="stat-label"><h4>{{ remaining_tasks }} Tasks Remaining</h4></div>
                        {% else %}
                        <div class="stat-label"><h4>No Tasks Remaining</h4></div>
                        {% endif %}
                    </div>
                </div>

                <div class="stat-card" data-stat="review">
                    <div class="stat-icon-wrapper">
                        <img src="/static/accounts/images/Reset-Clock--Streamline-Plump.svg" alt="" class="stat-icon">
                    </div>
                    <div class="stat-content">
                        <!-- <div class="stat-value"><h3></h3></div> -->
                        <div class="stat-label"><h4>{{ soonest.day }} Days Until Review</h4></div>
                    </div>
                </div>

                <div class="stat-card" data-stat="secured">
                    <div class="stat-icon-wrapper">
                        <img src="/static/accounts/images/User-Protection-Check--Streamline-Plump.svg" alt="" class="stat-icon">
                    </div>
                    <div class="stat-content">
                        <!-- <div class="stat-value"><h3>Secured</h3></div> -->
                        {% if accounts_count == 0 %}
                        <div class="stat-label"><h4>No Accounts Protected</h4></div>
                        {% elif accounts_count == 1 %}
                        <div class="stat-label"><h4>1 Account Protected</h4></div>
                        {% elif user.profile.accounts.all.count >= 2 %}
                        <div class="stat-label"><h4>{{ accounts_count }} Account Protected</h4></div>
                        {% endif %}
                    </div>
                </div>

                <div class="progress-card" data-stat="progress">
                    <div>
                        <input type="hidden" id="progress-value" value="{{ progress|default:0 }}">
                        {% include 'dashboard/progress-circle.html' %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Digital Estate Section -->
        <section class="dashboard-section mt-4">
            <h2>Digital Estate</h2>
            <div class="dashboard-grid">
                <!-- Accounts Card -->
                <div class="estate-card" data-category="accounts">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Padlock-Key--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not user.profile.accounts.all.count >= 1 %}
                        <span class="status-badge status-attention">Needs Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Accounts</h3>
                        <p class="card-description">Accounts with access details</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ user.profile.accounts.all.count }} accounts tracked</span>
                            {% if user.profile.accounts.last %}
                            <span class="meta-date">Last updated: {{ user.profile.accounts.last.updated_at|date:"M d, Y" }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:account_list' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Devices Card -->
                <div class="estate-card" data-category="devices">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Computer--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not devices_count %}
                        <span class="status-badge status-attention">Needs Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Devices</h3>
                        <p class="card-description">Device details</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ devices_count }} devices tracked</span>
                            {% if user.profile.devices.last %}
                            <span class="meta-date">Last updated: {{ user.profile.devices.last.updated_at|date:"M d, Y" }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:device_list' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Emergency Contacts Card -->
                <div class="estate-card" data-category="emergency">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Emergency--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not emergency_contacts_count %}
                        <span class="status-badge status-attention">Needs Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Contacts</h3>
                        <p class="card-description">Contact + Delegation</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ emergency_contacts_count }} emergency contacts</span>
                            {% if user.profile.emergency_contacts.last %}
                            <span class="meta-date">Last updated: {{ user.profile.emergency_contacts.last.updated_at|date:"M d, Y" }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:contact_list' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Estate Card -->
                <div class="estate-card" data-category="documents">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Script--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not estate_count %}
                        <span class="status-badge status-attention">Needs Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Estate Documents</h3>
                        <p class="card-description">Your comprehensive digital estate plan</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ estate_count }} estate documents</span>
                            {% if user.profile.estate_documents.last %}
                            <span class="meta-date">Last updated: {{ user.profile.estate_documents.last.updated_at|date:"M d, Y" }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:estate_list' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>


    
                <!-- Documents Card -->
                <div class="estate-card" data-category="documents">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Script--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not documents_count %}
                        <span class="status-badge status-attention">Needs Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Important Documents</h3>
                        <p class="card-description">Your comprehensive digital will and estate plan</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ documents_count }} documents</span>
                            {% if user.profile.documents.last.updated_at %}
                            <span class="meta-date">{Last updated: { user.profile.documents.last.updated_at|date:"M d, Y" }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:importantdocument_list' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Family Needs Card -->
                <div class="estate-card" data-category="family">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Family--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not family_needs_to_know_count %}
                        <span class="status-badge status-attention">Needs Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Family Needs to Know</h3>
                        <p class="card-description">Personal instructions and wishes for loved ones</p>
                        <div class="card-meta">
                            <span class="meta-item">Important information</span>
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:familyawareness_list' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Important Matters Card -->
                <div class="estate-card" data-category="matters">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Matters--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not user.profile.importantdocument.all.count %}
                        <span class="status-badge status-attention">Needs Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">What Matters</h3>
                        <p class="card-description">Priority matrix for critical accounts</p>
                        <div class="card-meta">
                            <span class="meta-item">Account priorities</span>
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:importantdocument_list' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Profile Card -->
                <div class="estate-card" data-category="profile">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Matters--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if not user.profile.full_name %}
                        <span class="status-badge status-attention">Review</span>
                        {% else %}
                        <span class="status-badge status-complete">Reviewed</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">My Profile</h3>
                        <p class="card-description">Personal information area</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ user.username }}</span>
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:profile_detail' %}" class="btn-card">
                            <span>View Details</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Scheduled Reviews Section -->
        <section class="dashboard-section">
            <h2>Scheduled Reviews & Checkups</h2>
            <div class="reviews-grid">
                <!-- Quarterly Review Card -->
                <div class="review-card" data-category="quarterly">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Calendar-Mark--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if alert_due %}
                        <span class="status-badge status-attention">Out of Date</span>
                        {% elif alert_attention %}
                        <span class="status-badge status-warning">Upcoming</span>
                        {% else %}
                        <span class="status-badge status-complete">Current</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Quarterly Digital Checkup</h3>
                        <p class="card-description">Quick review of recent account changes and updates</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ upcoming_review_days }} days until next review</span>
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:checkup_list' %}" class="btn-card">
                            <span>Update Now</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Annual Review Card -->
                <div class="review-card" data-category="annual">
                    <div class="card-icon-wrapper">
                        <img src="/static/accounts/images/Calendar-Add--Streamline-Plump.svg" alt="" class="card-icon">
                        <!-- <div class="icon-glow"></div> -->
                    </div>
                    
                    <div class="card-status">
                        {% if alert_due_year %}
                        <span class="status-badge status-attention">Out of Date</span>
                        {% elif alert_attention_year %}
                        <span class="status-badge status-warning">Upcoming</span>
                        {% else %}
                        <span class="status-badge status-complete">Current</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-content">
                        <h3 class="card-title">Annual Update + Re-certification</h3>
                        <p class="card-description">Comprehensive review and re-certify your digital estate</p>
                        <div class="card-meta">
                            <span class="meta-item">{{ furthest_review_days }} days until next review</span>
                        </div>
                    </div>
                    
                    <div class="card-action">
                        <a href="{% url 'dashboard:accountrelevancereview_list' %}" class="btn-card">
                            <span>Update Now</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </div>

    {% include "baseapp/footer.html" %}

    <script src="https://kit.fontawesome.com/ea6a27c21b.js" crossorigin="anonymous"></script>
    <script src="{% static 'dashboard/js/progress.js' %}"></script>
    <script>
        // Add staggered animation on page load
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.estate-card, .review-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.05}s`;
            });
        });
    </script>
</body>

</html>