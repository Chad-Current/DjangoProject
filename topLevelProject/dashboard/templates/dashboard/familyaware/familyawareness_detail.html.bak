{% extends "dashboard/dashboard.html" %}
{% load static %}

{% block title %}Family Note{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'dashboard/css/detail-view.css' %}" type="text/css">
<link rel="stylesheet" href="{% static 'dashboard/css/collapse.css' %}" type="text/css">
{% endblock %}

{% block content %}
<div class="main container py-4">

    <!-- Document Header -->
    <div class="document-header">
        <h1><i class="fas fa-users"></i> Family Note</h1>
        <div class="subtitle">For {{ familyawareness.relation.first_name }} {{ familyawareness.relation.last_name }}</div>
    </div>

    <div class="row">
        <!-- Left Column: Note Content & Categories -->
        <div class="col-lg-6">

            <!-- Note Content Card -->
            <div class="info-card">
                <h3><i class="fas fa-sticky-note"></i> Note Content</h3>
                <div class="description-box">
                    <p>{{ familyawareness.content|linebreaks }}</p>
                </div>
            </div>

            <!-- Categories Card -->
            <div class="info-card">
                <h3><i class="fas fa-tags"></i> This Note Covers</h3>

                <div class="condition-item {% if familyawareness.is_location_of_legal_will %}active{% else %}inactive{% endif %}">
                    <div>
                        <i class="fas {% if familyawareness.is_location_of_legal_will %}fa-check-circle{% else %}fa-times-circle{% endif %}"></i>
                        <strong class="ms-2">Location of Legal Will</strong>
                    </div>
                    {% if familyawareness.is_location_of_legal_will %}
                    <span class="condition-badge">Yes</span>
                    {% endif %}
                </div>

                <div class="condition-item {% if familyawareness.is_password_manager %}active{% else %}inactive{% endif %}">
                    <div>
                        <i class="fas {% if familyawareness.is_password_manager %}fa-check-circle{% else %}fa-times-circle{% endif %}"></i>
                        <strong class="ms-2">Password Manager Information</strong>
                    </div>
                    {% if familyawareness.is_password_manager %}
                    <span class="condition-badge">Yes</span>
                    {% endif %}
                </div>

                <div class="condition-item {% if familyawareness.is_social_media %}active{% else %}inactive{% endif %}">
                    <div>
                        <i class="fas {% if familyawareness.is_social_media %}fa-check-circle{% else %}fa-times-circle{% endif %}"></i>
                        <strong class="ms-2">How to Handle Social Media Accounts</strong>
                    </div>
                    {% if familyawareness.is_social_media %}
                    <span class="condition-badge">Yes</span>
                    {% endif %}
                </div>

                <div class="condition-item {% if familyawareness.is_photos_or_files %}active{% else %}inactive{% endif %}">
                    <div>
                        <i class="fas {% if familyawareness.is_photos_or_files %}fa-check-circle{% else %}fa-times-circle{% endif %}"></i>
                        <strong class="ms-2">What to Do with Photos or Files</strong>
                    </div>
                    {% if familyawareness.is_photos_or_files %}
                    <span class="condition-badge">Yes</span>
                    {% endif %}
                </div>

                <div class="condition-item {% if familyawareness.is_data_retention_preferences %}active{% else %}inactive{% endif %}">
                    <div>
                        <i class="fas {% if familyawareness.is_data_retention_preferences %}fa-check-circle{% else %}fa-times-circle{% endif %}"></i>
                        <strong class="ms-2">Data Retention Preferences</strong>
                    </div>
                    {% if familyawareness.is_data_retention_preferences %}
                    <span class="condition-badge">Yes</span>
                    {% endif %}
                </div>
            </div>

        </div>

        <!-- Right Column: Contact Info -->
        <div class="col-lg-6">

            <!-- Intended For Card -->
            <div class="info-card">
                <h3><i class="fas fa-user-check"></i> Intended For</h3>

                <div class="contact-card">
                    <h5>
                        <i class="fas fa-user-circle"></i>
                        <a href="{% url 'dashboard:contact_detail' familyawareness.relation.pk %}">
                            {{ familyawareness.relation.first_name }} {{ familyawareness.relation.last_name }}
                        </a>
                    </h5>

                    <div class="contact-info">
                        {% if familyawareness.relation.contact_relation %}
                        <div class="contact-info-item">
                            <i class="fas fa-heart"></i>
                            <span>{{ familyawareness.relation.get_contact_relation_display }}</span>
                        </div>
                        {% endif %}

                        {% if familyawareness.relation.email %}
                        <div class="contact-info-item">
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:{{ familyawareness.relation.email }}">{{ familyawareness.relation.email }}</a>
                        </div>
                        {% endif %}

                        {% if familyawareness.relation.phone %}
                        <div class="contact-info-item">
                            <i class="fas fa-phone"></i>
                            <a href="tel:{{ familyawareness.relation.phone }}">{{ familyawareness.relation.phone }}</a>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Contact Roles -->
                    {% if familyawareness.relation.is_emergency_contact or familyawareness.relation.is_digital_executor or familyawareness.relation.is_caregiver %}
                    <div class="mt-2">
                        {% if familyawareness.relation.is_emergency_contact %}
                        <span class="badge-role badge-emergency">
                            <i class="fas fa-exclamation-triangle"></i> Emergency Contact
                        </span>
                        {% endif %}

                        {% if familyawareness.relation.is_digital_executor %}
                        <span class="badge-role badge-executor">
                            <i class="fas fa-gavel"></i> Digital Executor
                        </span>
                        {% endif %}

                        {% if familyawareness.relation.is_caregiver %}
                        <span class="badge-role badge-caregiver">
                            <i class="fas fa-hands-helping"></i> Caregiver
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>

                <div class="description-box mt-3">
                    <p>
                        <i class="fas fa-info-circle"></i>
                        <strong>Note:</strong> This message is intended for
                        {{ familyawareness.relation.first_name }} {{ familyawareness.relation.last_name }}
                        ({{ familyawareness.relation.get_contact_relation_display }}).
                    </p>
                </div>
            </div>

        </div>
    </div>

    <!-- Metadata Footer -->
    <div class="metadata-footer">
        <div class="row">
            <div class="col-md-6 meta-item">
                <i class="fas fa-calendar-plus"></i>
                <strong>Created:</strong> {{ familyawareness.created_at|date:"F d, Y g:i A" }}
            </div>
            <div class="col-md-6 meta-item text-md-end">
                <i class="fas fa-calendar-check"></i>
                <strong>Last Updated:</strong> {{ familyawareness.updated_at|date:"F d, Y g:i A" }}
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    {% if can_modify %}
    <div class="action-buttons">
        <a href="{% url 'dashboard:familyawareness_update' familyawareness.pk %}" class="btn-edit btn-custom">
            <i class="fas fa-edit"></i> Edit Note
        </a>
        <a href="{% url 'dashboard:familyawareness_delete' familyawareness.pk %}" class="btn-delete btn-custom">
            <i class="fas fa-trash-alt"></i> Delete Note
        </a>
        <a href="{% url 'dashboard:familyawareness_list' %}" class="btn-back btn-custom">
            <i class="fas fa-arrow-left"></i> Back to List
        </a>
    </div>
    {% else %}
    <div class="action-buttons">
        <a href="{% url 'dashboard:familyawareness_list' %}" class="btn-back btn-custom">
            <i class="fas fa-arrow-left"></i> Back to List
        </a>
    </div>
    {% endif %}

</div>
{% endblock %}